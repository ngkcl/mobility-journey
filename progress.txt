## Codebase Patterns
- When adding new Expo Router routes, update `.expo/types/router.d.ts` so `router.push` stays type-safe.
- Keep Expo/React Native runtime-only modules (e.g. notifications) isolated from testable logic to avoid Node test loader issues.

---
## 2026-02-07 13:07 - Story WK-001: Exercise library with scoliosis-specific exercises

### Completed
- Added `exercises` Supabase table migration with seeded corrective + gym exercises.
- Built Exercise Library tab with search, category/target filters, and custom exercise creation.
- Added exercise detail screen showing targets, defaults, and side-specific emphasis.
- Added normalization utility + tests and updated route type definitions.

### Next Up (for next iteration)
- [ ] Start WK-002: workout logging tables + UI flow for workouts and sets.
- [ ] Confirm Supabase schema updates for workouts and workout_exercises.

### Blockers/Warnings
- `git push origin ralph/workout-tracker` failed: no `origin` remote configured.

### Files Changed
- supabase/migrations/20260207_exercises.sql
- lib/types.ts
- lib/exercises.ts
- lib/exercises.test.js
- app/(tabs)/exercises.tsx
- app/exercise/[id].tsx
- app/(tabs)/_layout.tsx
- .expo/types/router.d.ts
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- Added route typing update for new screens to keep `router.push` typecheck happy.
---
---
## 2026-02-07 13:14 - Story WK-002: Workout logging with sets, reps, weight

### Completed
- Added workouts/workout_exercises Supabase migration and new workout types.
- Built Workouts tab with start flow, exercise picker, per-set logging (side-specific), rest timer, and completion summary.
- Added workout summary utilities and tests for volume/left-right splits.

### Next Up (for next iteration)
- [ ] Start WK-003: corrective protocol templates and guided workout flow.
- [ ] Decide if workout history should include detail drill-down view.

### Blockers/Warnings
- `git push origin ralph/workout-tracker` failed: no `origin` remote configured.

### Files Changed
- supabase/migrations/20260207_workouts.sql
- lib/types.ts
- lib/workouts.ts
- lib/workouts.test.js
- app/(tabs)/workouts.tsx
- app/(tabs)/_layout.tsx
- .expo/types/router.d.ts
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- None.
---
---
## 2026-02-07 13:23 - Story WK-003: Corrective protocol templates (morning/midday/evening)

### Completed
- Added workout_templates Supabase migration with seeded morning/midday/evening corrective templates.
- Added guided protocol flow with timers, set tracking, and auto-advance, plus template customization UI.
- Added template helpers + tests for template set defaults.

### Next Up (for next iteration)
- [ ] Start WK-004: AI daily plan generator screen + API integration.
- [ ] Decide on workout history drill-down design for WK-005.

### Blockers/Warnings
- `git push origin ralph/workout-tracker` failed: no `origin` remote configured.

### Files Changed
- supabase/migrations/20260207_workout_templates.sql
- lib/types.ts
- lib/templates.ts
- lib/templates.test.js
- app/(tabs)/workouts.tsx
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- None.
---
---
## 2026-02-07 13:31 - Story WK-004: AI daily plan generator

### Completed
- Added daily plan Supabase table for generated plans with status tracking.
- Built Daily Plan tab with AI generation flow, plan editing, accept/regenerate actions, and plan history.
- Added daily plan normalization helpers and tests plus API client call.

### Next Up (for next iteration)
- [ ] Start WK-005: workout history list + analytics views.
- [ ] Confirm the daily plan API endpoint format matches the server implementation.

### Blockers/Warnings
- `git push origin ralph/workout-tracker` failed: no `origin` remote configured.

### Files Changed
- supabase/migrations/20260207_daily_plans.sql
- lib/api.ts
- lib/dailyPlan.ts
- lib/dailyPlan.test.js
- lib/types.ts
- app/(tabs)/plan.tsx
- app/(tabs)/_layout.tsx
- .expo/types/router.d.ts
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- None.
---
---
## 2026-02-07 13:38 - Story WK-005: Workout history and progress analytics

### Completed
- Extended workouts screen with history filters (date range, type, search) and expandable detail cards.
- Added workout analytics utilities and tests for consistency, streaks, volume, and side balance.
- Integrated workout analytics into Progress Charts with volume trends, strength progression, and left/right comparisons.

### Next Up (for next iteration)
- [ ] Start WK-006: workout reminders and scheduling.
- [ ] Confirm notification permissions flow for expo-notifications on iOS/Android.

### Blockers/Warnings
- None.

### Files Changed
- app/(tabs)/workouts.tsx
- app/(tabs)/charts.tsx
- lib/workoutAnalytics.ts
- lib/workoutAnalytics.test.js
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- None.
---
---
## 2026-02-07 14:09 - Story WK-006: Workout reminders and scheduling

### Completed
- Added workout schedule screen with session times, day toggles, and calendar preview.
- Implemented AsyncStorage-backed schedule normalization utilities and tests.
- Wired expo-notifications scheduling for corrective reminders/check-ins and added schedule access from Workouts.

### Next Up (for next iteration)
- [ ] Verify notification permissions + reminders on device (iOS/Android) and adjust channel config if needed.
- [ ] Decide if gym day reminders need a configurable time.

### Blockers/Warnings
- `git push origin ralph/workout-tracker` failed previously: no `origin` remote configured.

### Files Changed
- app/_layout.tsx
- app/(tabs)/workouts.tsx
- app/workout-schedule.tsx
- lib/workoutSchedule.ts
- lib/workoutSchedule.test.js
- lib/workoutNotifications.ts
- package.json
- pnpm-lock.yaml
- .expo/types/router.d.ts
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- None.
---

---
## 2025-02-09 - UX & Analytics Improvements

### Completed
1. **Fixed desktop TypeScript errors**
   - Added proper type declarations for @mediapipe/pose and @mediapipe/camera_utils
   - Added electron type reference for module resolution
   - Fixed posture-monitor.ts timer type (NodeJS.Timeout â†’ ReturnType<typeof setInterval>)
   - Updated tsconfig.json with custom typeRoots

2. **Enhanced workout analytics** (lib/workoutAnalytics.ts)
   - `buildOverallAsymmetryTrend`: Track L/R volume imbalance across ALL exercises
   - `computeAsymmetrySummary`: Trend direction (improving/worsening/stable), dominant side
   - `buildWorkoutPainTrend`: Pain/energy levels before and after workouts
   - `computePainImpact`: Average pain change after workouts

3. **Added EmptyState component** (components/EmptyState.tsx)
   - Reusable empty state with icon, title, description, and action button
   - Consistent styling with design system

4. **Charts page enhancement** (app/(tabs)/charts.tsx)
   - Added "Balance Status" card showing current asymmetry %, dominant side, trend direction
   - Added "Pain Impact" card showing average pain change from workouts
   - Color-coded indicators for improvement/concern status

### Next Up
- [ ] Add EmptyState to more screens (exercises, workouts, metrics)
- [ ] Improve loading skeletons for better perceived performance
- [ ] Consider adding accessibility labels for screen readers
- [ ] Implement AirPods integration (needs dev build)

### Files Changed
- desktop/src/types/mediapipe.d.ts (new)
- desktop/src/types/electron.d.ts (new)
- desktop/tsconfig.json
- desktop/src/renderer/lib/posture-monitor.ts
- lib/workoutAnalytics.ts
- components/EmptyState.tsx (new)
- app/(tabs)/charts.tsx
- progress.txt

### Learnings
- Browser setInterval returns number, not NodeJS.Timeout. Use ReturnType<typeof setInterval> for cross-platform compatibility.
- For packages without @types, create src/types/package.d.ts and add typeRoots to tsconfig.
