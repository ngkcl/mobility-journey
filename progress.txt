## Codebase Patterns
- Use valid expo-router typed routes (e.g. /analysis) for Link hrefs to satisfy typecheck.
- Unit tests run via `node --test` and use `ts-node/register/transpile-only` to import TS modules.

---
## 2026-02-07 12:32 - Story AP-002: Install and configure react-native-headphone-motion

### Completed
- Installed react-native-headphone-motion dependency.
- Added `useHeadphoneMotion` hook with permission handling, subscriptions, and graceful fallback.
- Marked AP-002 as passing in `prd.json`.

### Next Up (for next iteration)
- [ ] Implement AP-003: slouch detection engine with calibration and debouncing.
- [ ] Wire slouch detection into a new posture monitor screen.

### Blockers/Warnings
- `git push` failed because no `origin` remote is configured.

### Files Changed
- lib/useHeadphoneMotion.ts
- package.json
- pnpm-lock.yaml
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- None.
---
## 2026-02-07 12:29 - Story AP-001: Switch to development build with expo-dev-client

### Completed
- Installed expo-dev-client and updated lockfile.
- Set iOS bundle identifier and NSMotionUsageDescription in app.json.
- Ran `npx expo prebuild` successfully to generate native folders.
- Fixed expo-router typed Link target in not-found screen to pass typecheck.

### Next Up (for next iteration)
- [ ] Implement AP-002: add react-native-headphone-motion and create hook.
- [ ] Add motion permission handling and fallback UI behavior.

### Blockers/Warnings
- CocoaPods gem install failed; Homebrew install succeeded during prebuild.
- Native folders `ios/` and `android/` are gitignored; regenerate as needed.
- `git push` failed because no `origin` remote is configured.

### Files Changed
- app.json
- app/+not-found.tsx
- package.json
- pnpm-lock.yaml
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- Expo prebuild will try gem install for CocoaPods first, then fall back to Homebrew.
---
---
## 2026-02-07 12:35 - Story AP-003: Slouch detection engine

### Completed
- Added slouch detection engine with calibration, thresholds, debouncing, and state transitions.
- Emitted slouch events on WARNING/SLOUCHING transitions with timestamp and duration metadata.
- Added node-based unit tests for slouch detection logic.

### Next Up (for next iteration)
- [ ] Implement AP-004: posture monitor screen with real-time feedback using slouch detector + headphone motion hook.
- [ ] Consider wiring detector into UI state with live stats + session timer.

### Blockers/Warnings
- `git push` failed because no `origin` remote is configured.

### Files Changed
- lib/slouchDetector.ts
- lib/slouchDetector.test.js
- package.json
- pnpm-lock.yaml
- prd.json
- progress.txt

### Learnings (add to Codebase Patterns if reusable)
- None.
---
